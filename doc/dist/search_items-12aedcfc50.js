searchNodes=[{"doc":"Couchx context module","ref":"Couchx.html","title":"Couchx","type":"module"},{"doc":"Adapter to get basic query functionality into Ecto with CouchDB . Configuration It uses the same as Ecto pattern to config the Dbs with this format: config :my_app , MyRepo , username : &quot;username&quot; , password : &quot;password&quot; , database : &quot;db_name&quot; , hostname : &quot;localhost&quot; , protocol : &quot;http&quot; , port : 5984 Usage Couchx supports 1 main repo and many dynamic supervised repos. A dynamic repo will allow you to have multiple db connections in your application. To achieve this, you will need to setup a DynamicSupervisor and a Registry in the application like: def start ( _type , _args ) do children = [ { DynamicSupervisor , strategy : :one_for_one , name : CouchxSupervisor } { Registry , keys : :unique , name : CouchxRegistry } , ... ] ... end The Restry name is tied up to the code so it must be called CouchxRegistry . The main Repo is configured as any other Ecto Repo, so you can start it in the application just adding it to the children list. def start ( _type , _args ) do children = [ MyDb.Repo ] ... end Dynamic Repo queries The dynamic repos are implemente with a Macro that you can get into your repo as: use CouchxDyncamicTepo , otp_app : :my_app , name : :my_repo This is used to setup a run function, with a callback as argument. To execute actions in a dynamic repo we follow this pattern: MyDynamicRepo . run ( -&gt; MyDynamicRepo . get ( MyStruct , doc_id ) end ) Any Repo call inside the callback function will be run in a dynamically supervised connection. Migrations Couchx comes with a Mango index generator. Example $ mix couchx.gen.mango_index -r MyApp.Repo -n my-mango-index -f username,email This will create a file under priv/my_app/repo/index/my-mango-index.exs with contents as: defmodule MyApp.Repo.Index.MyMangoIndex do use Couchx.MangoIndex , repo_name : MyApp.Repo def up do create_index &quot;my-mango-index&quot; do %{ fields : [ &quot;username&quot; , &quot;email&quot; ] , } end end def down do drop_index &quot;my-mango-index&quot; end end The Map inside the create_index block will be added to the index json object, so any structure that can go there can be added here. Currently only supported methods are create_index(String.t(), (-&gt; Map.t())) name: ID and Name for the index to be created in CouchDB, this will be used as id for the document persisted. fun: A block that returns a formated Map for the index to be created, it will be parsed as JSON to the body of the index document. drop_index(String.t()) name: Id and Name for the index document to be deleted Examples $ mix couchx.mango_index Will add all indexes store under `priv/my_app/repo/index/` paths $ mix couchx.mango_index.down -r MyApp.Repo -n my-mango-index,my-other-index It will call down function on the Migration files ``` priv/my_app/repo/index/my-mango-index.exs priv/my_app/repo/index/my-other-index.exs ``` Removing the documents from the database.","ref":"Couchx.Adapter.html","title":"Couchx.Adapter","type":"module"},{"doc":"Callback implementation for Ecto.Adapter.Schema.autogenerate/1 .","ref":"Couchx.Adapter.html#autogenerate/1","title":"Couchx.Adapter.autogenerate/1","type":"function"},{"doc":"Callback implementation for Ecto.Adapter.checked_out?/1 .","ref":"Couchx.Adapter.html#checked_out?/1","title":"Couchx.Adapter.checked_out?/1","type":"function"},{"doc":"Callback implementation for Ecto.Adapter.checkout/3 .","ref":"Couchx.Adapter.html#checkout/3","title":"Couchx.Adapter.checkout/3","type":"function"},{"doc":"","ref":"Couchx.Adapter.html#create_admin/3","title":"Couchx.Adapter.create_admin/3","type":"function"},{"doc":"","ref":"Couchx.Adapter.html#create_db/2","title":"Couchx.Adapter.create_db/2","type":"function"},{"doc":"Callback implementation for Ecto.Adapter.Schema.delete/4 .","ref":"Couchx.Adapter.html#delete/4","title":"Couchx.Adapter.delete/4","type":"function"},{"doc":"","ref":"Couchx.Adapter.html#delete_admin/2","title":"Couchx.Adapter.delete_admin/2","type":"function"},{"doc":"","ref":"Couchx.Adapter.html#delete_db/2","title":"Couchx.Adapter.delete_db/2","type":"function"},{"doc":"","ref":"Couchx.Adapter.html#do_insert/6","title":"Couchx.Adapter.do_insert/6","type":"function"},{"doc":"Callback implementation for Ecto.Adapter.dumpers/2 .","ref":"Couchx.Adapter.html#dumpers/2","title":"Couchx.Adapter.dumpers/2","type":"function"},{"doc":"Callback implementation for Ecto.Adapter.ensure_all_started/2 .","ref":"Couchx.Adapter.html#ensure_all_started/2","title":"Couchx.Adapter.ensure_all_started/2","type":"function"},{"doc":"Callback implementation for Ecto.Adapter.Queryable.execute/5 .","ref":"Couchx.Adapter.html#execute/5","title":"Couchx.Adapter.execute/5","type":"function"},{"doc":"","ref":"Couchx.Adapter.html#execute/6","title":"Couchx.Adapter.execute/6","type":"function"},{"doc":"Callback implementation for Ecto.Adapter.init/1 .","ref":"Couchx.Adapter.html#init/1","title":"Couchx.Adapter.init/1","type":"function"},{"doc":"Callback implementation for Ecto.Adapter.Schema.insert/6 .","ref":"Couchx.Adapter.html#insert/6","title":"Couchx.Adapter.insert/6","type":"function"},{"doc":"","ref":"Couchx.Adapter.html#insert_all/7","title":"Couchx.Adapter.insert_all/7","type":"function"},{"doc":"Callback implementation for Ecto.Adapter.Schema.insert_all/8 .","ref":"Couchx.Adapter.html#insert_all/8","title":"Couchx.Adapter.insert_all/8","type":"function"},{"doc":"Callback implementation for Ecto.Adapter.loaders/2 .","ref":"Couchx.Adapter.html#loaders/2","title":"Couchx.Adapter.loaders/2","type":"function"},{"doc":"","ref":"Couchx.Adapter.html#parse_bulk_response/3","title":"Couchx.Adapter.parse_bulk_response/3","type":"function"},{"doc":"Callback implementation for Ecto.Adapter.Queryable.prepare/2 .","ref":"Couchx.Adapter.html#prepare/2","title":"Couchx.Adapter.prepare/2","type":"function"},{"doc":"Callback implementation for Ecto.Adapter.Queryable.stream/5 .","ref":"Couchx.Adapter.html#stream/5","title":"Couchx.Adapter.stream/5","type":"function"},{"doc":"Callback implementation for Ecto.Adapter.Schema.update/6 .","ref":"Couchx.Adapter.html#update/6","title":"Couchx.Adapter.update/6","type":"function"},{"doc":"","ref":"Couchx.Adapter.html#update!/6","title":"Couchx.Adapter.update!/6","type":"function"},{"doc":"","ref":"Couchx.Constraint.html","title":"Couchx.Constraint","type":"module"},{"doc":"","ref":"Couchx.Constraint.html#call/4","title":"Couchx.Constraint.call/4","type":"function"},{"doc":"","ref":"Couchx.CouchId.html","title":"Couchx.CouchId","type":"module"},{"doc":"","ref":"Couchx.CouchId.html#base_id/1","title":"Couchx.CouchId.base_id/1","type":"function"},{"doc":"","ref":"Couchx.CouchId.html#underscore_school_id/1","title":"Couchx.CouchId.underscore_school_id/1","type":"function"},{"doc":"","ref":"Couchx.DbConnection.html","title":"Couchx.DbConnection","type":"module"},{"doc":"","ref":"Couchx.DbConnection.html#all_docs/3","title":"Couchx.DbConnection.all_docs/3","type":"function"},{"doc":"","ref":"Couchx.DbConnection.html#bulk_docs/3","title":"Couchx.DbConnection.bulk_docs/3","type":"function"},{"doc":"Returns a specification to start this module under a supervisor. See Supervisor .","ref":"Couchx.DbConnection.html#child_spec/1","title":"Couchx.DbConnection.child_spec/1","type":"function"},{"doc":"","ref":"Couchx.DbConnection.html#create_admin/3","title":"Couchx.DbConnection.create_admin/3","type":"function"},{"doc":"","ref":"Couchx.DbConnection.html#create_db/2","title":"Couchx.DbConnection.create_db/2","type":"function"},{"doc":"","ref":"Couchx.DbConnection.html#delete/3","title":"Couchx.DbConnection.delete/3","type":"function"},{"doc":"","ref":"Couchx.DbConnection.html#delete/4","title":"Couchx.DbConnection.delete/4","type":"function"},{"doc":"","ref":"Couchx.DbConnection.html#delete_admin/2","title":"Couchx.DbConnection.delete_admin/2","type":"function"},{"doc":"","ref":"Couchx.DbConnection.html#delete_db/2","title":"Couchx.DbConnection.delete_db/2","type":"function"},{"doc":"","ref":"Couchx.DbConnection.html#find/3","title":"Couchx.DbConnection.find/3","type":"function"},{"doc":"","ref":"Couchx.DbConnection.html#get/4","title":"Couchx.DbConnection.get/4","type":"function"},{"doc":"","ref":"Couchx.DbConnection.html#index/2","title":"Couchx.DbConnection.index/2","type":"function"},{"doc":"","ref":"Couchx.DbConnection.html#info/1","title":"Couchx.DbConnection.info/1","type":"function"},{"doc":"Callback implementation for GenServer.init/1 .","ref":"Couchx.DbConnection.html#init/1","title":"Couchx.DbConnection.init/1","type":"function"},{"doc":"","ref":"Couchx.DbConnection.html#insert/4","title":"Couchx.DbConnection.insert/4","type":"function"},{"doc":"","ref":"Couchx.DbConnection.html#raw_request/4","title":"Couchx.DbConnection.raw_request/4","type":"function"},{"doc":"","ref":"Couchx.DbConnection.html#start_link/1","title":"Couchx.DbConnection.start_link/1","type":"function"},{"doc":"","ref":"Couchx.DocumentState.html","title":"Couchx.DocumentState","type":"module"},{"doc":"","ref":"Couchx.DocumentState.html#merge_constraints/1","title":"Couchx.DocumentState.merge_constraints/1","type":"function"},{"doc":"","ref":"Couchx.DocumentState.html#process_constraints/2","title":"Couchx.DocumentState.process_constraints/2","type":"function"},{"doc":"","ref":"Couchx.DynamicRepo.html","title":"Couchx.DynamicRepo","type":"module"},{"doc":"","ref":"Couchx.Finders.html","title":"Couchx.Finders","type":"module"},{"doc":"","ref":"Couchx.MangoIndex.html","title":"Couchx.MangoIndex","type":"module"},{"doc":"","ref":"Couchx.Migrator.html","title":"Couchx.Migrator","type":"module"},{"doc":"","ref":"Couchx.Migrator.html#run/2","title":"Couchx.Migrator.run/2","type":"function"},{"doc":"","ref":"Couchx.Migrator.html#run/3","title":"Couchx.Migrator.run/3","type":"function"},{"doc":"","ref":"Couchx.Migrator.html#run_direction/2","title":"Couchx.Migrator.run_direction/2","type":"function"},{"doc":"","ref":"Couchx.PrepareQuery.html","title":"Couchx.PrepareQuery","type":"module"},{"doc":"","ref":"Couchx.PrepareQuery.html#call/1","title":"Couchx.PrepareQuery.call/1","type":"function"},{"doc":"","ref":"Couchx.QueryHandler.html","title":"Couchx.QueryHandler","type":"module"},{"doc":"","ref":"Couchx.QueryHandler.html#query_results/3","title":"Couchx.QueryHandler.query_results/3","type":"function"},{"doc":"","ref":"Couchx.Support.ApplicationHelper.html","title":"Couchx.Support.ApplicationHelper","type":"module"},{"doc":"","ref":"Couchx.Support.ApplicationHelper.html#base_repo_path/2","title":"Couchx.Support.ApplicationHelper.base_repo_path/2","type":"function"},{"doc":"","ref":"Mix.Tasks.Couchx.Gen.MangoIndex.html","title":"Mix.Tasks.Couchx.Gen.MangoIndex","type":"task"},{"doc":"Creates the index documents defined in the priv/repo/index/ path. The migration files should be exs files and can have a up and down functions. Examples defmodule MyApp.Repo.Index.MyIndex do use Couchx.MangoIndex , repo_name : BS.Repo def up do create_index ( &quot;my-index&quot; ) do %{ fields : [ &quot;name&quot; , &quot;email&quot; ] } end end def down do drop_index ( &quot;my-index&quot; ) end end Current convention is that the file name uses - to separate words, and this is used to create de module name. Example $ priv/my_repo/index/my-index.exs $ mix couchx.mango_index Couchx will need knowledge of the main OTP app supervising the repos, also we need to configure ecto repos. Example confix :couchx , otp_app : :my_app config :my_app , ecto_repos : [ MyApp.Repo , Custom.Repo ] The task will look for paths for all the repos and process the indexes it finds.","ref":"Mix.Tasks.Couchx.MangoIndex.html","title":"Mix.Tasks.Couchx.MangoIndex","type":"task"},{"doc":"Deletes an index or list of indexes provided from the Repo DB. The Repo passed as -r or --r will define the DB to lookup for the index document. There is also a parameter set as -n or --names which will need to match the ddoc and the index name . Examples $ mix couchx.mango_index.down -r MyApp.Repo -n my-index-ddoc The Repo have to match one in the config.exs file. Also couchx will need knowledge of the main OTP app supervising the repos. Examples confix :couchx , otp_app : :my_app config :my_app , ecto_repos : [ MyApp.Repo , Custom.Repo ]","ref":"Mix.Tasks.Couchx.MangoIndex.Down.html","title":"Mix.Tasks.Couchx.MangoIndex.Down","type":"task"},{"doc":"","ref":"Mix.Tasks.Couchx.MangoIndex.Down.html#prepend/2","title":"Mix.Tasks.Couchx.MangoIndex.Down.prepend/2","type":"function"},{"doc":"","ref":"Couchx.DbError.html","title":"Couchx.DbError","type":"exception"}]